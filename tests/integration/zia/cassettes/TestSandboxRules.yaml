interactions:
- request:
    body: '{"name": "tests-vcr0001", "description": "Integration test Sandbox Rule",
      "baRuleAction": "BLOCK", "state": "ENABLED", "order": 1, "rank": 7, "firstTimeEnable":
      true, "mlActionEnabled": true, "firstTimeOperation": "ALLOW_SCAN", "urlCategories":
      ["OTHER_ADULT_MATERIAL"], "protocols": ["FOHTTP_RULE", "FTP_RULE", "HTTPS_RULE",
      "HTTP_RULE"], "baPolicyCategories": ["ADWARE_BLOCK", "BOTMAL_BLOCK", "ANONYP2P_BLOCK",
      "RANSOMWARE_BLOCK"], "fileTypes": ["FTCATEGORY_BZIP2", "FTCATEGORY_P7Z"], "byThreatScore":
      40}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '507'
      Content-Type:
      - application/json
      User-Agent:
      - zscaler-sdk-python/2.0.0 python/3.11.8 Darwin/24.6.0
    method: POST
    uri: https://easm.test.zscaler.com/zia/api/v1/sandboxRules
  response:
    body:
      string: '{"id":1582215,"name":"tests-vcr0001","protocols":["FOHTTP_RULE","FTP_RULE","HTTPS_RULE","HTTP_RULE"],"order":1,"baPolicyCategories":["ADWARE_BLOCK","BOTMAL_BLOCK","ANONYP2P_BLOCK","RANSOMWARE_BLOCK"],"description":"Integration
        test Sandbox Rule","urlCategories":["OTHER_ADULT_MATERIAL"],"fileTypes":["FTCATEGORY_BZIP2","FTCATEGORY_P7Z"],"state":"ENABLED","rank":7,"baRuleAction":"BLOCK","firstTimeEnable":true,"firstTimeOperation":"ALLOW_SCAN","mlActionEnabled":true,"defaultRule":false,"byThreatScore":40}'
    headers:
      cache-control:
      - no-store, no-cache
      content-disposition:
      - attachment; filename="api.json"
      content-encoding:
      - gzip
      content-security-policy:
      - 'default-src ''none''; img-src ''self'' data: https://www.zscaler.com https://www.zscaler.fr
        https://a.tile.openstreetmap.org                 https://b.tile.openstreetmap.org
        https://c.tile.openstreetmap.org                 https://webapi.zscaler.com
        https://cdn.zscaler.com https://server.arcgisonline.com                 https://fast.wistia.com
        https://cms.zscaler.com; script-src ''self'' ''unsafe-eval'' https://*.userpilot.io
        https://webapi.zscaler.com/                 https://www.zscaler.com/api/admin-ui-messages/
        https://webapi.zscaler.com/                 https://fast.wistia.com; style-src
        ''unsafe-inline'' https:; font-src ''self''; connect-src ''self'' https://*.userpilot.io
        wss://analytex-us.userpilot.io; frame-src ''self'' https://help.zscaler.com/
        https://help.zscalergov.net https://help.zscaler.us; manifest-src ''self'''
      content-type:
      - application/json
      date:
      - Sat, 06 Dec 2025 00:17:40 GMT
      server:
      - Zscaler
      strict-transport-security:
      - max-age=31536000; includeSubDomains; preload
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-envoy-upstream-service-time:
      - '2596'
      x-frame-options:
      - SAMEORIGIN
      x-oneapi-host:
      - https://apiusw2.zsapi.net
      x-oneapi-request-id:
      - c8ec9b4f-2c6e-935e-82ec-a94cc811767f
      x-oneapi-version:
      - 109.1.92
      x-ratelimit-limit:
      - 5000, 5000;w=60
      x-ratelimit-remaining:
      - '4983'
      x-ratelimit-reset:
      - '23'
      x-transaction-id:
      - 2650278a-e9f6-4ee4-9536-42904cc5ef43
      x-xss-protection:
      - 1; mode=block
      x-zscaler-mode:
      - read-write
    status:
      code: 200
      message: OK
- request:
    body: '{}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '2'
      Content-Type:
      - application/json
      User-Agent:
      - zscaler-sdk-python/2.0.0 python/3.11.8 Darwin/24.6.0
    method: GET
    uri: https://easm.test.zscaler.com/zia/api/v1/sandboxRules/1582215
  response:
    body:
      string: '{"id":1582215,"name":"tests-vcr0001","protocols":["FOHTTP_RULE","FTP_RULE","HTTPS_RULE","HTTP_RULE"],"order":1,"baPolicyCategories":["ADWARE_BLOCK","BOTMAL_BLOCK","ANONYP2P_BLOCK","RANSOMWARE_BLOCK"],"description":"Integration
        test Sandbox Rule","urlCategories":["OTHER_ADULT_MATERIAL"],"fileTypes":["FTCATEGORY_BZIP2","FTCATEGORY_P7Z"],"cbiProfileId":0,"state":"ENABLED","rank":7,"lastModifiedTime":1764980259,"lastModifiedBy":{"id":117810311,"name":"REDACTED"},"accessControl":"READ_WRITE","baRuleAction":"BLOCK","firstTimeEnable":true,"firstTimeOperation":"ALLOW_SCAN","mlActionEnabled":true,"defaultRule":false,"byThreatScore":40}'
    headers:
      cache-control:
      - no-store, no-cache
      content-disposition:
      - attachment; filename="api.json"
      content-encoding:
      - gzip
      content-security-policy:
      - 'default-src ''none''; img-src ''self'' data: https://www.zscaler.com https://www.zscaler.fr
        https://a.tile.openstreetmap.org                 https://b.tile.openstreetmap.org
        https://c.tile.openstreetmap.org                 https://webapi.zscaler.com
        https://cdn.zscaler.com https://server.arcgisonline.com                 https://fast.wistia.com
        https://cms.zscaler.com; script-src ''self'' ''unsafe-eval'' https://*.userpilot.io
        https://webapi.zscaler.com/                 https://www.zscaler.com/api/admin-ui-messages/
        https://webapi.zscaler.com/                 https://fast.wistia.com; style-src
        ''unsafe-inline'' https:; font-src ''self''; connect-src ''self'' https://*.userpilot.io
        wss://analytex-us.userpilot.io; frame-src ''self'' https://help.zscaler.com/
        https://help.zscalergov.net https://help.zscaler.us; manifest-src ''self'''
      content-type:
      - application/json
      date:
      - Sat, 06 Dec 2025 00:17:41 GMT
      server:
      - Zscaler
      strict-transport-security:
      - max-age=31536000; includeSubDomains; preload
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-envoy-upstream-service-time:
      - '832'
      x-frame-options:
      - SAMEORIGIN
      x-oneapi-host:
      - https://apiusw2.zsapi.net
      x-oneapi-request-id:
      - 005c5279-a83b-9cf9-91f5-d4621f10234c
      x-oneapi-version:
      - 109.1.92
      x-ratelimit-limit:
      - 5000, 5000;w=60
      x-ratelimit-remaining:
      - '4982'
      x-ratelimit-reset:
      - '20'
      x-transaction-id:
      - 2650278a-e9f6-4ee4-9536-42904cc5ef43
      x-xss-protection:
      - 1; mode=block
      x-zscaler-mode:
      - read-write
    status:
      code: 200
      message: OK
- request:
    body: '{"name": "tests-vcr0001", "description": "Updated integration test Sandbox
      Rule", "baRuleAction": "ALLOW", "state": "ENABLED", "order": 1, "rank": 7, "firstTimeEnable":
      true, "mlActionEnabled": true, "firstTimeOperation": "ALLOW_SCAN", "urlCategories":
      ["OTHER_ADULT_MATERIAL"], "protocols": ["FOHTTP_RULE", "FTP_RULE", "HTTPS_RULE",
      "HTTP_RULE"], "baPolicyCategories": ["ADWARE_BLOCK", "BOTMAL_BLOCK", "ANONYP2P_BLOCK",
      "RANSOMWARE_BLOCK"], "fileTypes": ["FTCATEGORY_BZIP2", "FTCATEGORY_P7Z"], "byThreatScore":
      45}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '515'
      Content-Type:
      - application/json
      User-Agent:
      - zscaler-sdk-python/2.0.0 python/3.11.8 Darwin/24.6.0
    method: PUT
    uri: https://easm.test.zscaler.com/zia/api/v1/sandboxRules/1582215
  response:
    body:
      string: '{"id":1582215,"name":"tests-vcr0001","protocols":["FOHTTP_RULE","FTP_RULE","HTTPS_RULE","HTTP_RULE"],"order":1,"baPolicyCategories":["ADWARE_BLOCK","BOTMAL_BLOCK","ANONYP2P_BLOCK","RANSOMWARE_BLOCK"],"description":"Updated
        integration test Sandbox Rule","urlCategories":["OTHER_ADULT_MATERIAL"],"fileTypes":["FTCATEGORY_BZIP2","FTCATEGORY_P7Z"],"cbiProfileId":0,"state":"ENABLED","rank":7,"lastModifiedTime":1764980262,"lastModifiedBy":{"id":117810311,"name":"REDACTED"},"accessControl":"READ_WRITE","baRuleAction":"ALLOW","firstTimeEnable":true,"firstTimeOperation":"ALLOW_SCAN","mlActionEnabled":true,"defaultRule":false,"byThreatScore":45}'
    headers:
      cache-control:
      - no-store, no-cache
      content-disposition:
      - attachment; filename="api.json"
      content-encoding:
      - gzip
      content-security-policy:
      - 'default-src ''none''; img-src ''self'' data: https://www.zscaler.com https://www.zscaler.fr
        https://a.tile.openstreetmap.org                 https://b.tile.openstreetmap.org
        https://c.tile.openstreetmap.org                 https://webapi.zscaler.com
        https://cdn.zscaler.com https://server.arcgisonline.com                 https://fast.wistia.com
        https://cms.zscaler.com; script-src ''self'' ''unsafe-eval'' https://*.userpilot.io
        https://webapi.zscaler.com/                 https://www.zscaler.com/api/admin-ui-messages/
        https://webapi.zscaler.com/                 https://fast.wistia.com; style-src
        ''unsafe-inline'' https:; font-src ''self''; connect-src ''self'' https://*.userpilot.io
        wss://analytex-us.userpilot.io; frame-src ''self'' https://help.zscaler.com/
        https://help.zscalergov.net https://help.zscaler.us; manifest-src ''self'''
      content-type:
      - application/json
      date:
      - Sat, 06 Dec 2025 00:17:44 GMT
      server:
      - Zscaler
      strict-transport-security:
      - max-age=31536000; includeSubDomains; preload
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-envoy-upstream-service-time:
      - '2630'
      x-frame-options:
      - SAMEORIGIN
      x-oneapi-host:
      - https://apiusw2.zsapi.net
      x-oneapi-request-id:
      - e9675d41-7dba-955a-a2a4-2487f92ef9da
      x-oneapi-version:
      - 109.1.92
      x-ratelimit-limit:
      - 5000, 5000;w=60
      x-ratelimit-remaining:
      - '4981'
      x-ratelimit-reset:
      - '19'
      x-transaction-id:
      - 2650278a-e9f6-4ee4-9536-42904cc5ef43
      x-xss-protection:
      - 1; mode=block
      x-zscaler-mode:
      - read-write
    status:
      code: 200
      message: OK
- request:
    body: '{}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '2'
      Content-Type:
      - application/json
      User-Agent:
      - zscaler-sdk-python/2.0.0 python/3.11.8 Darwin/24.6.0
    method: DELETE
    uri: https://easm.test.zscaler.com/zia/api/v1/sandboxRules/1582215
  response:
    body:
      string: ''
    headers:
      cache-control:
      - no-store, no-cache
      content-disposition:
      - attachment; filename="api.json"
      content-security-policy:
      - 'default-src ''none''; img-src ''self'' data: https://www.zscaler.com https://www.zscaler.fr
        https://a.tile.openstreetmap.org                 https://b.tile.openstreetmap.org
        https://c.tile.openstreetmap.org                 https://webapi.zscaler.com
        https://cdn.zscaler.com https://server.arcgisonline.com                 https://fast.wistia.com
        https://cms.zscaler.com; script-src ''self'' ''unsafe-eval'' https://*.userpilot.io
        https://webapi.zscaler.com/                 https://www.zscaler.com/api/admin-ui-messages/
        https://webapi.zscaler.com/                 https://fast.wistia.com; style-src
        ''unsafe-inline'' https:; font-src ''self''; connect-src ''self'' https://*.userpilot.io
        wss://analytex-us.userpilot.io; frame-src ''self'' https://help.zscaler.com/
        https://help.zscalergov.net https://help.zscaler.us; manifest-src ''self'''
      date:
      - Sat, 06 Dec 2025 00:17:46 GMT
      server:
      - Zscaler
      strict-transport-security:
      - max-age=31536000; includeSubDomains; preload
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-envoy-upstream-service-time:
      - '2222'
      x-frame-options:
      - SAMEORIGIN
      x-oneapi-host:
      - https://apiusw2.zsapi.net
      x-oneapi-request-id:
      - 18f480bc-44ff-9208-88ea-59b478081431
      x-oneapi-version:
      - 109.1.92
      x-ratelimit-limit:
      - 5000, 5000;w=60
      x-ratelimit-remaining:
      - '4980'
      x-ratelimit-reset:
      - '16'
      x-transaction-id:
      - 2650278a-e9f6-4ee4-9536-42904cc5ef43
      x-xss-protection:
      - 1; mode=block
      x-zscaler-mode:
      - read-write
    status:
      code: 204
      message: No Content
version: 1
